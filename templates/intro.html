<html lang="ko">
<head>
    <title>너만 타냐?</title>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <!-- Bulma CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">
    
    <!--  bootstrap  -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>
    
    <!-- JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    
    <!--  추가 css  -->
    <link rel="stylesheet" href="../static/css/intro.css">
    <link rel="stylesheet" href="../static/css/common.css">
    <link href="https://fonts.googleapis.com/css2?family=Jua&amp;display=swap" rel="stylesheet">
    
    <script>
        // ['쿠키'라는 개념에 대해 알아봅시다]
        // 로그인을 구현하면, 반드시 쿠키라는 개념을 사용합니다.
        // 페이지에 관계없이 브라우저에 임시로 저장되는 정보입니다. 키:밸류 형태(딕셔너리 형태)로 저장됩니다.
        // 쿠키가 있기 때문에, 한번 로그인하면 네이버에서 다시 로그인할 필요가 없는 것입니다.
        // 브라우저를 닫으면 자동 삭제되게 하거나, 일정 시간이 지나면 삭제되게 할 수 있습니다.
        function login() {
            $.ajax({
                type: "POST",
                url: "/api/login",
                data: {id_give: $('#userid').val(), pw_give: $('#userpw').val()},
                success: function (response) {
                    if (response['result'] == 'success') {
                        // 로그인이 정상적으로 되면, 토큰을 받아옵니다.
                        // 이 토큰을 mytoken이라는 키 값으로 쿠키에 저장합니다.
                        $.cookie('mytoken', response['token']);
                        
                        alert('로그인 완료!')
                        location.replace("/amusementpark")
                    } else {
                        // 로그인이 안되면 에러메시지를 띄웁니다.
                        alert(response['msg'])
                    }
                }
            })
        }
        
        // 간단한 회원가입 함수입니다.
        // 아이디, 비밀번호, 닉네임을 받아 DB에 저장합니다.
        var id_check = 0;

        function register() {
            if (id_check == 0) {
                alert('ID CHECK를 해주세요.')
            } else {
                $.ajax({
                    type: "POST",
                    url: "/api/register",
                    data: {
                        id_give: $('#signup_username').val(),
                        pw_give: $('#signup_userid').val(),
                        name_give: $('#signup_userpw').val()
                    },
                    success: function (response) {
                        if (response['result'] == 'success') {
                            alert('회원가입이 완료되었습니다.')
                            location.replace("/")
                        } else {
                            alert(response['msg'])
                        }
                    }
                })
                }
        }


        function idCheck(){
            let signup_userid_check = $('#signup_userid').val()
            console.log(signup_userid_check)

            $.ajax({
                type: "GET",
                url: "/api/register/id_check",
                data: {
                    signup_userid_give: signup_userid_check
                },
                success: function (response) {
                    if (response['status'] == 'success') {
                        alert(response['msg'])
                        id_check = 1;
                    } else {
                        alert(response['msg'])
                        id_check = 0;
                    }
                }
            })
        }
        
        
        $(function () {
            $("#login_btn").click(function () {
                $(".login_modal").modal("show");
                $(".login_modal").css("padding-right", 0);
                $("body").css("padding-right", 0)
            });
            
            $("#login_modal_close").click(function () {
                $(".login_modal").modal("hide");
            });
            
            $("#login_close_btn").click(function () {
                $(".login_modal").modal("hide");
            });
            
            $("#sign_up_btn").click(function () {
                $(".sign_up_modal").modal("show");
                $(".sign_up_modal").css("padding-right", 0);
                $("body").css("padding-right", 0)
            });
            
            $("#sign_up_modal_close").click(function () {
                $(".sign_up_modal").modal("hide");
            });
            
            $("#sign_up_close_btn").click(function () {
                $(".sign_up_modal").modal("hide");
            });
            
        });
    </script>

</head>

<body>
<div class="container-fluid">
    <div class="wrap">
        <div class="txt_box">
            <h2>즐거움은 혼자서 만드는 게 아닙니다.</h2>
            <p>함께 만들고 함께 공유해 나가는 것이죠</p>
            <h1>"너만 타냐?"</h1>
        </div>
        <div class="btn_box">
            <div class="login_btn_box">
                <!-- Button trigger modal -->
                <button type="button" id="login_btn" class="btn btn-light" data-toggle="modal"
                        data-target="#loginModalCenter">
                    로그인
                </button>
            
            
            </div>
            <div class="sign_btn_box">
                <button type="button" id="sign_up_btn" class="btn btn-light" data-toggle="modal"
                        data-target="#signUpModalCenter">
                    회원가입
                </button>
            </div>
        </div>
    
    
    </div>

</div>

<!-- Modal -->
<div class="modal fade login_modal" id="loginModalCenter" tabindex="500" role="dialog"
     aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">로그인</h5>
                <button type="button" id="login_modal_close" class="close" data-dismiss="modal" aria-label="Close"
                        style="border: 0; background-color: #fff;">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="field is-horizontal">
                    <div class="field-label is-normal">
                        <label class="label" for="userid">ID</label>
                    </div>
                    <div class="field-body">
                        <div class="field">
                            <div class="control">
                                <input type="text" class="input" id="userid" aria-describedby="emailHelp"
                                       placeholder="ID">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="field is-horizontal">
                    <div class="field-label is-normal">
                        <label class="label" for="userpw">PW</label>
                    </div>
                    <div class="field-body">
                        <div class="field">
                            <div class="control">
                                <input type="password" class="input" id="userpw" placeholder="PASSWORD">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="login_go_btn" class="btn btn-primary" onclick="login()">Log In</button>
                <button type="button" id="login_close_btn" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>


<!-- signup_Modal -->
<div class="modal fade sign_up_modal" id="signUpModalCenter" tabindex="500" role="dialog"
     aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="signUpModalLongTitle">회원가입</h5>
                <button type="button" id="sign_up_modal_close" class="close" data-dismiss="modal" aria-label="Close"
                        style="border: 0; background-color: #fff;">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="field is-horizontal">
                    <div class="field-label is-normal">
                        <label class="label" for="signup_username">이름</label>
                    </div>
                    <div class="field-body">
                        <div class="field">
                            <div class="control">
                                <input type="text" class="input" id="signup_username" placeholder="NAME">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="field is-horizontal">
                    <div class="field-label is-normal">
                        <label class="label" for="signup_userid">ID</label>
                    </div>
                    <div class="field-body">
                        <div class="field">
                            <div class="control">
                                <input type="text" class="input" id="signup_userid" aria-describedby="emailHelp"
                                       placeholder="ID">
                            </div>
                        </div>
                        <div class="id_check_btn_box">
                            <button type="button" id="id_check_btn" class="btn btn-primary" onclick="idCheck()">ID CHECK</button>
{#                            <button>ID CHECK</button>#}
                        </div>
                    </div>
                </div>
                <div class="field is-horizontal">
                    <div class="field-label is-normal">
                        <label class="label" for="signup_userpw">PW</label>
                    </div>
                    <div class="field-body">
                        <div class="field">
                            <div class="control">
                                <input type="password" class="input" id="signup_userpw" placeholder="PASSWORD">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="field is-horizontal">
                    <div class="field-label is-normal">
                        <label class="label" for="signup_userpw_check">PW CHECK</label>
                    </div>
                    <div class="field-body">
                        <div class="field">
                            <div class="control">
                                <input type="password" class="input" id="signup_userpw_check" placeholder="PASSWORD CHECK">
                            </div>
                        </div>
                    </div>
                </div>
            
            </div>
            <div class="modal-footer">
                <button type="button" id="submit_btn" class="btn btn-success" onclick="register()">Join</button>
                <button type="button" id="sign_up_close_btn" class="btn btn-secondary" data-dismiss="modal">Close
                </button>
            </div>
        </div>
    </div>
</div>


</body>
</html>